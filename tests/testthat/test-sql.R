context("sql")

test_that("Correct SQL query is returned", {
  expect_equal(
    tidypredict_sql(lm(mpg~., data = mtcars), dbplyr::simulate_dbi()),  
    dbplyr::sql("12.3033741559962 + (\"cyl\" * -0.111440477886862) + (\"disp\" * 0.0133352399133411) + (\"hp\" * -0.0214821189891363) + (\"drat\" * 0.787110972236117) + (\"wt\" * -3.71530392832747) + (\"qsec\" * 0.821040749674628) + (\"vs\" * 0.317762814185421) + (\"am\" * 2.52022688720842) + (\"gear\" * 0.655413017081793) + (\"carb\" * -0.199419254856269)")
  )
  expect_equal(
    tidypredict_sql_interval(lm(mpg~wt, data = mtcars), dbplyr::simulate_dbi()),
    dbplyr::sql("2.04227245630124 * SQRT(-0.176776695296637 * -0.176776695296637 * 9.27739791811145 + -0.590557271637747 + \"wt\" * 0.183559646169165 * -0.590557271637747 + \"wt\" * 0.183559646169165 * 9.27739791811145 + 9.27739791811145)")
  )  
})
